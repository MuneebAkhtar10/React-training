{"ast":null,"code":"var _jsxFileName = \"/home/dev/Desktop/react-firebase/src/components/Airline/Airline.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport AxiosHelper from '../../utils/Requests/AxiosHelper';\nimport styled from 'styled-components';\nimport Review from './Review';\nimport ReviewForm from './ReviewForm';\nimport Header from './Header';\nimport airlineQuery from '../../queries/airlineQuery';\nimport createReviewQuery from '../../queries/createReviewQuery';\nimport deleteReviewQuery from '../../queries/deleteReviewQuery';\nimport GetNested from '../../utils/Helpers/GetNested';\nconst Wrapper = styled.div`\n  margin-left: auto;\n  margin-right: auto;\n`;\nconst Column = styled.div`\n  background: #fff; \n  max-width: 50%;\n  width: 50%;\n  float: left; \n  height: 100vh;\n  overflow-x: scroll;\n  overflow-y: scroll; \n  overflow: scroll;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  &:last-child {\n    background: black;\n    border-top: 1px solid rgba(255,255,255,0.5);\n  }\n`;\nconst Main = styled.div`\n  padding-left: 60px;\n`;\n\nconst Airline = props => {\n  const [airline, setAirline] = useState({});\n  const [review, setReview] = useState({});\n  const [error, setError] = useState('');\n  useEffect(() => {\n    const slug = props.match.params.slug; // This uses the v2 api (graphql) as of 05/09/2020.\n    // For the v1 api endpoint use: axios.get('/api/v1/airlines/:slug')\n\n    axios.post('/api/v2/graphql', {\n      query: airlineQuery(slug)\n    }).then(resp => setAirline(resp.data.data.airline)).catch(data => console.log('Error', data));\n  }, []); // Modify text in review form\n\n  const handleChange = e => {\n    e.preventDefault();\n    setReview(Object.assign({}, review, {\n      [e.target.name]: e.target.value\n    }));\n  }; // Create a review\n\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    AxiosHelper();\n    const airlineId = parseInt(airline.id); // This uses the v2 api (graphql) as of 05/09/2020.\n    // For the v1 api endpoint use: axios.post('/api/v1/reviews')\n\n    axios.post('/api/v2/graphql', {\n      query: createReviewQuery({ ...review,\n        airlineId\n      })\n    }).then(resp => {\n      const payload = resp.data.data.createReview;\n\n      if (payload.error || payload.message == 'failure') {\n        setError(payload.error);\n      } else {\n        const reviews = [...airline.reviews, payload];\n        setAirline({ ...airline,\n          reviews\n        });\n        setReview({\n          title: '',\n          description: '',\n          score: 0\n        });\n        setError('');\n      }\n    }).catch(resp => {\n      let error;\n\n      switch (resp.message) {\n        case \"Request failed with status code 401\":\n          error = 'Please log in to leave a review.';\n          break;\n\n        default:\n          error = 'Something went wrong.';\n      }\n\n      setError(error);\n    });\n  }; // Destroy a review\n\n\n  const handleDestroy = (id, e) => {\n    e.preventDefault();\n    axios.post('/api/v2/graphql', {\n      query: deleteReviewQuery(id)\n    }).then(data => {\n      let reviews = [...airline.reviews];\n      const index = reviews.findIndex(data => data.id == id);\n      reviews.splice(index, 1);\n      setAirline({ ...airline,\n        reviews\n      });\n    }).catch(data => console.log('Error', data));\n  }; // set score\n\n\n  const setRating = (score, e) => {\n    e.preventDefault();\n    setReview({ ...review,\n      score\n    });\n  };\n\n  const name = GetNested(airline, 'name');\n  const image_url = GetNested(airline, 'imageUrl');\n  let total,\n      average = 0;\n  let airlineReviews;\n\n  if (airline.reviews && airline.reviews.length > 0) {\n    total = airline.reviews.reduce((total, review) => total + review.score, 0);\n    average = total > 0 ? parseFloat(total) / parseFloat(airline.reviews.length) : 0;\n    airlineReviews = airline.reviews.map((review, index) => {\n      return /*#__PURE__*/React.createElement(Review, {\n        key: index,\n        id: review.id,\n        attributes: review,\n        handleDestroy: handleDestroy,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 9\n        }\n      });\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(Wrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Main, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    image_url: image_url,\n    name: name,\n    reviews: airline.reviews,\n    average: average,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 11\n    }\n  }), airlineReviews)), /*#__PURE__*/React.createElement(Column, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ReviewForm, {\n    name: name,\n    review: review,\n    handleChange: handleChange,\n    handleSubmit: handleSubmit,\n    setRating: setRating,\n    error: error,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default Airline;","map":{"version":3,"sources":["/home/dev/Desktop/react-firebase/src/components/Airline/Airline.js"],"names":["React","useState","useEffect","axios","AxiosHelper","styled","Review","ReviewForm","Header","airlineQuery","createReviewQuery","deleteReviewQuery","GetNested","Wrapper","div","Column","Main","Airline","props","airline","setAirline","review","setReview","error","setError","slug","match","params","post","query","then","resp","data","catch","console","log","handleChange","e","preventDefault","Object","assign","target","name","value","handleSubmit","airlineId","parseInt","id","payload","createReview","message","reviews","title","description","score","handleDestroy","index","findIndex","splice","setRating","image_url","total","average","airlineReviews","length","reduce","parseFloat","map"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from 'axios'\nimport AxiosHelper from '../../utils/Requests/AxiosHelper'\nimport styled from 'styled-components'\nimport Review from './Review'\nimport ReviewForm from './ReviewForm'\nimport Header from './Header'\nimport airlineQuery from '../../queries/airlineQuery'\nimport createReviewQuery from '../../queries/createReviewQuery'\nimport deleteReviewQuery from '../../queries/deleteReviewQuery'\nimport GetNested from '../../utils/Helpers/GetNested'\n\nconst Wrapper = styled.div`\n  margin-left: auto;\n  margin-right: auto;\n`\n\nconst Column = styled.div`\n  background: #fff; \n  max-width: 50%;\n  width: 50%;\n  float: left; \n  height: 100vh;\n  overflow-x: scroll;\n  overflow-y: scroll; \n  overflow: scroll;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  &:last-child {\n    background: black;\n    border-top: 1px solid rgba(255,255,255,0.5);\n  }\n`\n\nconst Main = styled.div`\n  padding-left: 60px;\n`\n\nconst Airline = (props) => {\n  const [airline, setAirline] = useState({})\n  const [review, setReview] = useState({})\n  const [error, setError] = useState('')\n\n  useEffect(()=> {\n    const slug = props.match.params.slug\n    // This uses the v2 api (graphql) as of 05/09/2020.\n    // For the v1 api endpoint use: axios.get('/api/v1/airlines/:slug')\n    axios.post('/api/v2/graphql', { query: airlineQuery(slug) })\n    .then( (resp) => setAirline(resp.data.data.airline))\n    .catch( data => console.log('Error', data) )\n  }, [])\n\n  // Modify text in review form\n  const handleChange = (e) => {\n    e.preventDefault()\n\n    setReview(Object.assign({}, review, {[e.target.name]: e.target.value}))\n  }\n\n  // Create a review\n  const handleSubmit = (e) => {\n    e.preventDefault()\n\n    AxiosHelper()\n\n    const airlineId = parseInt(airline.id)\n    // This uses the v2 api (graphql) as of 05/09/2020.\n    // For the v1 api endpoint use: axios.post('/api/v1/reviews')\n    axios.post('/api/v2/graphql', { query: createReviewQuery({ ...review, airlineId }) })\n    .then( (resp) => {\n      const payload = resp.data.data.createReview\n      if (payload.error || payload.message == 'failure') {\n        setError(payload.error)\n      } else {\n        const reviews = [ ...airline.reviews, payload ]\n        setAirline({ ...airline, reviews })\n        setReview({ title: '', description: '', score: 0 })\n        setError('')\n      }\n    })\n    .catch( resp => {\n      let error\n      switch(resp.message){\n        case \"Request failed with status code 401\":\n          error = 'Please log in to leave a review.'\n          break\n        default:\n          error = 'Something went wrong.'\n      }\n      setError(error)\n    })\n  }\n\n  // Destroy a review\n  const handleDestroy = (id, e) => {\n    e.preventDefault()\n    axios.post('/api/v2/graphql', { query: deleteReviewQuery(id) })\n    .then( (data) => {\n      let reviews = [...airline.reviews]\n      const index = reviews.findIndex( (data) => data.id == id )\n      reviews.splice(index, 1)\n\n      setAirline({ ...airline, reviews })\n    })\n    .catch( data => console.log('Error', data) )\n  }\n\n  // set score\n  const setRating = (score, e) => {\n    e.preventDefault()  \n    setReview({ ...review, score })\n  }\n\n  const name = GetNested(airline, 'name')\n  const image_url = GetNested(airline, 'imageUrl')\n  \n  let total, average = 0\n  let airlineReviews\n\n  if (airline.reviews && airline.reviews.length > 0) {\n    total = airline.reviews.reduce((total, review) => total + review.score, 0)\n    average = total > 0 ? (parseFloat(total) / parseFloat(airline.reviews.length)) : 0\n    \n    airlineReviews = airline.reviews.map( (review, index) => {\n      return (\n        <Review \n          key={index}\n          id={review.id}\n          attributes={review}\n          handleDestroy={handleDestroy}\n        />\n      )\n    })\n  }\n\n  return(\n    <Wrapper>\n      <Column>\n        <Main>\n          <Header \n            image_url={image_url}\n            name={name}\n            reviews={airline.reviews}\n            average={average}\n          />\n          {airlineReviews}\n        </Main>\n      </Column>\n      <Column>\n        <ReviewForm\n          name={name}\n          review={review}\n          handleChange={handleChange}\n          handleSubmit={handleSubmit}\n          setRating={setRating}\n          error={error}\n        />\n      </Column>\n    </Wrapper>\n  )\n}\n\nexport default Airline\n"]},"metadata":{},"sourceType":"module"}